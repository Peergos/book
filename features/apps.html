<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Custom Apps</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../overview/overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../features/features.html"><strong aria-hidden="true">2.</strong> Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../features/self.html"><strong aria-hidden="true">2.1.</strong> Self hosting</a></li><li class="chapter-item expanded "><a href="../features/p2p.html"><strong aria-hidden="true">2.2.</strong> Peer-to-peer</a></li><li class="chapter-item expanded "><a href="../features/trust.html"><strong aria-hidden="true">2.3.</strong> Trust free server</a></li><li class="chapter-item expanded "><a href="../features/multi.html"><strong aria-hidden="true">2.4.</strong> Multi-device login</a></li><li class="chapter-item expanded "><a href="../features/web.html"><strong aria-hidden="true">2.5.</strong> Web interface</a></li><li class="chapter-item expanded "><a href="../features/social.html"><strong aria-hidden="true">2.6.</strong> Social</a></li><li class="chapter-item expanded "><a href="../features/sharing.html"><strong aria-hidden="true">2.7.</strong> Sharing</a></li><li class="chapter-item expanded "><a href="../features/large.html"><strong aria-hidden="true">2.8.</strong> Large files</a></li><li class="chapter-item expanded "><a href="../features/streaming.html"><strong aria-hidden="true">2.9.</strong> Streaming</a></li><li class="chapter-item expanded "><a href="../features/fast-seeking.html"><strong aria-hidden="true">2.10.</strong> Fast seeking</a></li><li class="chapter-item expanded "><a href="../features/resumable-uploads.html"><strong aria-hidden="true">2.11.</strong> Resumable uploads</a></li><li class="chapter-item expanded "><a href="../features/viewers.html"><strong aria-hidden="true">2.12.</strong> File viewers</a></li><li class="chapter-item expanded "><a href="../features/secret.html"><strong aria-hidden="true">2.13.</strong> Secret links</a></li><li class="chapter-item expanded "><a href="../features/migration.html"><strong aria-hidden="true">2.14.</strong> Migration</a></li><li class="chapter-item expanded "><a href="../features/sync.html"><strong aria-hidden="true">2.15.</strong> File Sync</a></li><li class="chapter-item expanded "><a href="../features/open.html"><strong aria-hidden="true">2.16.</strong> Open source</a></li><li class="chapter-item expanded "><a href="../features/apps.html" class="active"><strong aria-hidden="true">2.17.</strong> Custom Apps</a></li><li class="chapter-item expanded "><a href="../features/private-web.html"><strong aria-hidden="true">2.18.</strong> Private websites</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/architecture.html"><strong aria-hidden="true">3.</strong> Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/logical.html"><strong aria-hidden="true">3.1.</strong> Logical</a></li><li class="chapter-item expanded "><a href="../architecture/physical.html"><strong aria-hidden="true">3.2.</strong> Physical</a></li><li class="chapter-item expanded "><a href="../architecture/immutable.html"><strong aria-hidden="true">3.3.</strong> Immutable data</a></li><li class="chapter-item expanded "><a href="../architecture/mutable.html"><strong aria-hidden="true">3.4.</strong> Mutable pointers</a></li><li class="chapter-item expanded "><a href="../architecture/writer.html"><strong aria-hidden="true">3.5.</strong> Writing subspaces</a></li><li class="chapter-item expanded "><a href="../architecture/champ.html"><strong aria-hidden="true">3.6.</strong> Merkle-CHAMP</a></li><li class="chapter-item expanded "><a href="../architecture/pki.html"><strong aria-hidden="true">3.7.</strong> Usernames</a></li><li class="chapter-item expanded "><a href="../architecture/follow.html"><strong aria-hidden="true">3.8.</strong> Follow requests</a></li><li class="chapter-item expanded "><a href="../architecture/spec.html"><strong aria-hidden="true">3.9.</strong> Specification</a></li></ol></li><li class="chapter-item expanded "><a href="../security/security.html"><strong aria-hidden="true">4.</strong> Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../security/trust.html"><strong aria-hidden="true">4.1.</strong> Trust free layers</a></li><li class="chapter-item expanded "><a href="../security/threats.html"><strong aria-hidden="true">4.2.</strong> Threat models</a></li><li class="chapter-item expanded "><a href="../security/login.html"><strong aria-hidden="true">4.3.</strong> Login</a></li><li class="chapter-item expanded "><a href="../security/encryption.html"><strong aria-hidden="true">4.4.</strong> Encryption</a></li><li class="chapter-item expanded "><a href="../security/bats.html"><strong aria-hidden="true">4.5.</strong> Block access control</a></li><li class="chapter-item expanded "><a href="../security/cryptree.html"><strong aria-hidden="true">4.6.</strong> File access control</a></li><li class="chapter-item expanded "><a href="../security/capabilities.html"><strong aria-hidden="true">4.7.</strong> Capabilities</a></li><li class="chapter-item expanded "><a href="../security/meta.html"><strong aria-hidden="true">4.8.</strong> Metadata</a></li><li class="chapter-item expanded "><a href="../security/quantum.html"><strong aria-hidden="true">4.9.</strong> Quantum resistance</a></li><li class="chapter-item expanded "><a href="../security/social.html"><strong aria-hidden="true">4.10.</strong> Social graph</a></li><li class="chapter-item expanded "><a href="../security/pki.html"><strong aria-hidden="true">4.11.</strong> PKI</a></li></ol></li><li class="chapter-item expanded "><a href="../dev/details.html"><strong aria-hidden="true">5.</strong> How does it work?</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dev/signup.html"><strong aria-hidden="true">5.1.</strong> Signing up</a></li><li class="chapter-item expanded "><a href="../dev/upload.html"><strong aria-hidden="true">5.2.</strong> Uploading a file</a></li><li class="chapter-item expanded "><a href="../dev/follow.html"><strong aria-hidden="true">5.3.</strong> Sending a follow request</a></li><li class="chapter-item expanded "><a href="../dev/proxy.html"><strong aria-hidden="true">5.4.</strong> Proxying requests</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="custom-apps"><a class="header" href="#custom-apps">Custom Apps</a></h1>
<p>Peergos Apps are a way to extend the Peergos platform to add custom functionality</p>
<p>When an app is run, its HTML5 assets are rendered in a unique hostname (sha256(app path).$peergos-domain) of the peergos server, e.g. https://bciqjmdntozhuanb2c3ka5vtqpux75j5symbyomhkpnilndngl6iaspy.peergos.net. The app domain is isolated from the main peergos domain in a separate OS process, and from other apps. The app domain is also locked down with CSP http headers so it cannot make any external requests which could be used to exfilrate data [0]. Requests made by the app are intercepted in a service worker and translated to post messages which are sent to the main peergos tab. That is where the requests are checked for validity and permissions are enforced. By default, an app has no permissions and can only read its own assets. Running an app also doesn't reveal its assets to the server - they are served via a service worker and post messages to the main peergos tab, and thus benefit from all the existing privacy protections in Peergos.</p>
<img alt="App sandbox" src="/img/sandbox.jpeg" class="center" style="width: 100%;" />
<p>[0] This is currently not true until browsers implement <a href="https://github.com/w3c/webappsec-csp/issues/92">webrtc CSP</a> which blocks any webrtc connections. Browser issues for this are <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1783489">firefox</a>, <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1225968">Chrome</a>. So only install apps from authors you trust for now, unless they don't require any permissions which is safe.</p>
<h2 id="use-cases"><a class="header" href="#use-cases">Use cases:</a></h2>
<ol>
<li>
<p>Media Player App. The App should appear as a context menu item when a media file is selected on the Drive screen.</p>
</li>
<li>
<p>Word Processor App. As well as having read access to a document file, the App should be able to overwrite the contents of the document file.</p>
</li>
<li>
<p>Image Gallery App. The App should be able to read image files from the selected Folder tree.</p>
</li>
<li>
<p>White Board App. App will appear on the Launcher page. App can create, retrieve, update, append and delete files within it’s own App space.</p>
</li>
</ol>
<h2 id="example-apps"><a class="header" href="#example-apps">Example apps</a></h2>
<p>You can find some example apps here: <a href="https://github.com/Peergos/example-apps">https://github.com/Peergos/example-apps</a></p>
<h2 id="anatomy-of-a-peergos-app"><a class="header" href="#anatomy-of-a-peergos-app">Anatomy of a Peergos App</a></h2>
<p>An app consists of plain HTML/Javascript/CSS packaged in a folder</p>
<p>The App is described by a mandatory manifest file called peergos-app.json</p>
<h3 id="app-folder-structure"><a class="header" href="#app-folder-structure">App Folder Structure</a></h3>
<p>asssets					- Must contain index.html as an entry point</p>
<p>data					- Files under the control of the App</p>
<p>peergos-app.json		- manifest file</p>
<h3 id="peergos-appjson"><a class="header" href="#peergos-appjson">Peergos-app.json</a></h3>
<p>This file describes the App. It also indicates the permissions required for the App to function</p>
<p>Fields:</p>
<p>schemaVersion	- Currently always set to 1</p>
<p>displayName		- Used for display.  Limited to 25 characters. (alphanumeric plus dash and underscore).</p>
<p>version			- Format of Major.Minor.Patch-Suffix. Example: 0.0.1-initial</p>
<p>description		- Text. Length must not exceed 100 characters</p>
<p>author			- Text. Length must not exceed 32 characters</p>
<p>fileExtensions	- Array of target file extensions e.g. ["jpg","png","gif"]</p>
<p>mimeTypes		- Array of target mime types e.g. ["application/zip","application/vnd.peergos-todo","video/quicktime"]</p>
<p>fileTypes		- Another way to target files e.g. [“image”, “video”, “audio”, “text”]</p>
<p>launchable		- Indicates App can be opened on the Launcher page</p>
<p>folderAction	- Indicates App acts on folders</p>
<p>appIcon			- filename of image to use as icon on launcher page. Must be available in assets folder</p>
<p>permissions		- see below</p>
<p>Permissions:</p>
<p>STORE_APP_DATA	- Can store and read files in a folder private to the app</p>
<p>EDIT_CHOSEN_FILE – Can modify file chosen by user</p>
<p>READ_CHOSEN_FOLDER – Can read contents of folder chosen by user</p>
<p>EXCHANGE_MESSAGES_WITH_FRIENDS - Can exchange messages with friends</p>
<p>ACCESS_PROFILE_PHOTO - Can retrieve profile photos shared with you</p>
<p>CSP_UNSAFE_EVAL - Allow app to modify its own code via calls to eval()</p>
<p>A minimal peergos-app.json file would look like:</p>
<pre><code class="language-js">{
    "displayName": "App",
    "description": "does something",
    "launchable": true  	
}
</code></pre>
<p>These are already quite powerful, but we plan to add more permissions as we see more use cases.</p>
<h2 id="peergos-rest-api"><a class="header" href="#peergos-rest-api">Peergos REST API</a></h2>
<p>The following endpoints are available:</p>
<p>/peergos-api/v0/data/path.to.file – The data folder is where the App can store and retrieve files</p>
<p>/peergos-api/v0/form/path.to.file – An app can POST a HTML Form and have the results stored in a file of the same name in the data folder.</p>
<p>/peergos-api/v0/chat/ - An app can use the chat api for communication between friends.</p>
<p>If an App is launched from a file/folder context menu item, the path of the file/folder will be available via:</p>
<pre><code class="language-js">let url = new URL(window.location.href);
let filePath = url.searchParams.get("path");
</code></pre>
<p>Dark mode can be detected via the theme param</p>
<pre><code class="language-js">let theme = url.searchParams.get("theme");// curent values: ['dark-mode', '']
</code></pre>
<h3 id="drive---the-following-http-actions-are-supported"><a class="header" href="#drive---the-following-http-actions-are-supported">Drive - The following HTTP actions are supported:</a></h3>
<p>Note: /peergos-api/v0/data/ is only relevant for the App's data folder. It is not necessary when referencing a file in the App's assets folder or the folder/file selected by the user.</p>
<p>GET – Retrieve a resource. Can be a file or folder</p>
<p>Response code: 200 – success.</p>
<p>404, 400 – request failed</p>
<p>Notes:</p>
<ol>
<li>
<p>If resource is a folder the response will look like: {files:[“file1.txt”, “file2.txt”], subFolders:[“folder”]}</p>
</li>
<li>
<p>If the file is a media file with a thumbnail, provide ?preview=true to the request to have the thumbnail returned in the Response as a Base64 string.</p>
</li>
</ol>
<p>POST – Create a resource</p>
<p>Response code: 201 – create success. See Response header field: location</p>
<p>200 for POST using form/</p>
<p>400 – request failed</p>
<p>PUT – update a resource</p>
<p>Response code: 201 – create success. See Response header field: location</p>
<p>200 – for update success</p>
<p>400 – request failed</p>
<p>DELETE – delete a file</p>
<p>204 – delete success</p>
<p>400 – request failed</p>
<p>PATCH – append to a file only supported</p>
<p>204 – Append success. See Response header field: Content-Location</p>
<p>400 – request failed</p>
<p>PUT|POST - save a file (launches a dialog)</p>
<p>/peergos-api/v0/save/filename.txt</p>
<p>Request body set to contents of file to save</p>
<p>Response code: 200 or 201 – success.</p>
<p>GET - launch folder picker</p>
<p>/peergos-api/v0/folders</p>
<p>Response code: 200 and an array of the selected paths.</p>
<p>GET - launch file picker</p>
<p>/peergos-api/v0/file-picker
Optional url parameter ?extension="json" to filter files shown in picker.</p>
<p>Response code: 200 and an array containing the selected file path.</p>
<h3 id="chat-v0---the-following-http-actions-are-supported-see-chat-api-in-example-apps"><a class="header" href="#chat-v0---the-following-http-actions-are-supported-see-chat-api-in-example-apps">Chat V0 - The following HTTP actions are supported (see chat-api in example-apps):</a></h3>
<p>See Chat V1 below for a more comprehensive API to support more complex apps</p>
<p>GET – Retrieve a list of all chats created by this App</p>
<p>/peergos-api/v0/chat/</p>
<p>Response code: 200 – success.</p>
<p>Response:</p>
<p>{chatId: chatId, title: title}</p>
<p>GET – Retrieve chat messages</p>
<p>/peergos-api/v0/chat/:chatId</p>
<p>Url Parameters:</p>
<p>from - paging from index</p>
<p>to - paging to index</p>
<p>Response code: 200 – success.</p>
<p>Response:</p>
<p>{messages:[], count: messagesRead}</p>
<p>Contents of messages array:</p>
<p>{type: 'Application', id: messageHash, text: text, author: author, timestamp: timestamp}</p>
<p>{type: 'Join', username: username, timestamp: timestamp}</p>
<p>POST - create chat</p>
<p>/peergos-api/v0/chat/</p>
<p>Request FormData</p>
<p>parameters:</p>
<p>maxInvites - Numeric</p>
<p>Response code: 201 – success.</p>
<p>Response header:</p>
<p>Location - chatId</p>
<p>PUT - send message</p>
<p>/peergos-api/v0/chat/:chatId</p>
<p>Request FormData</p>
<p>parameters:</p>
<p>text - Contents of message</p>
<p>Response code: 201 – success.</p>
<h3 id="chat-v1---the-following-http-actions-are-supported-see-chat-folder-in-example-apps"><a class="header" href="#chat-v1---the-following-http-actions-are-supported-see-chat-folder-in-example-apps">Chat V1 - The following HTTP actions are supported (see chat folder in example-apps):</a></h3>
<p>GET – Retrieve chats for current App</p>
<p>/peergos-api/v1/chat/</p>
<p>Response code: 200 – success.</p>
<p>Response:</p>
<p>{chats: [], latestMessages: []}</p>
<p>Contents of chats array:</p>
<p>{chatId: string, title: string, members: [usernames], admins: [usernames] }</p>
<p>Contents of latestMessages array (array entries match corresponding chats array):</p>
<p>{message: string, creationTime: timestamp (localdatetime)}</p>
<p>GET – Retrieve chat messages</p>
<p>/peergos-api/v1/chat/:chatId</p>
<p>Url Parameters:</p>
<p>startIndex - message index</p>
<p>Response code: 200 – success.</p>
<p>Response:</p>
<p>{chatId: string, startIndex: url param from request, messages: array of message json,
hasFriendsInChat: number of friends in current chat membership}</p>
<p>Where message is</p>
<p>{ messageRef: string uuid, author: username, timestamp: localdatetime,</p>
<p>type: can be one of RemoveMember|Invite|Join|GroupState|ReplyTo|Delete|Edit|Application ,</p>
<p>removeUsername: set if type is RemoveMember, inviteUsername: set if type is Invite, joinUsername: set if type is Join,</p>
<p>editPriorVersion: set if type is Edit, deleteTarget: set if type is Delete, replyToParent: set if type is ReplyTo,</p>
<p>text: set if type is Application|Edit|ReplyTo, envelope: base64 encoded opaque object,</p>
<p>groupState: set if type is GroupState, attachments : array of attachment json}</p>
<p>Where GroupState is</p>
<p>{ key: payload.key, value: payload.value}</p>
<p>Where attachment is</p>
<p>{fileRef: FileRef json, mimeType: mimeType of file, fileType: audio|video|image, thumbnail: base64 encoded thumbnail for file}</p>
<p>see FileRef description in API call for /attachment response)</p>
<p>DELETE - delete a chat</p>
<p>/peergos-api/v1/chat/:chatId</p>
<p>Response code: 204 – success.</p>
<p>DELETE - delete an attachment</p>
<p>/peergos-api/v1/chat/filePath</p>
<p>Response code: 204 – success.</p>
<p>POST - launch chat group membership modal in order to create a new chat</p>
<p>/peergos-api/v1/chat/</p>
<p>Response code: 201 – success. 400 - failure or modal closed</p>
<p>Response (location response header field):</p>
<p>{chatId: string, title: string, members: [username], admins: [username]};</p>
<p>POST - launch chat group membership modal in order to modify membership of existing chat</p>
<p>/peergos-api/v1/chat/:chatId</p>
<p>Response code: 200 – success. 400 - failure or modal closed</p>
<p>POST - launch gallery modal to display media attachment</p>
<p>/peergos-api/v1/chat/?view=true</p>
<p>Request body:</p>
<p>byte[] of FileRef json (see fileRef field in API call /attachment response)</p>
<p>Response code: 200</p>
<p>POST - download a media attachment</p>
<p>/peergos-api/v1/chat/?download=true</p>
<p>Request body:</p>
<p>byte[] of FileRef json (see fileRef field in API call /attachment response)</p>
<p>Response code: 200</p>
<p>POST - upload a media attachment</p>
<p>/peergos-api/v1/chat/attachment?filename=filename-of-file-to-upload</p>
<p>Request body:</p>
<p>byte[] of attachment's content</p>
<p>Response code: 201</p>
<p>Response (location response header field):</p>
<p>{fileRef: FileRef json, hasMediaFile: boolean, hasThumbnail: boolean, thumbnail: base64 string of thumbnail image,</p>
<p>fileType: file type string ie audio, image, video, mimeType: mimeType string, size: number }</p>
<p>where FileRef is</p>
<p>{path: absolute path to file, cap: opaque capability object, contentHash: hash of file contents}</p>
<p>PUT - send a message</p>
<p>/peergos-api/v1/chat/:chatId</p>
<p>Request body:</p>
<p>to create message</p>
<p>{ createMessage : { text: string, attachments: array of FileRef json} }</p>
<p>to edit existing message</p>
<p>{ editMessage : { text: string, messageRef: uuid of message to edit} }</p>
<p>to reply to an existing message</p>
<p>{ replyMessage : { text: string, attachments: array of FileRef json, replyTo: envelope of message to reply to} }</p>
<p>to delete an existing message</p>
<p>{ deleteMessage : { messageRef: uuid of message to delete} }</p>
<p>Response code: 201</p>
<h3 id="profile"><a class="header" href="#profile">Profile:</a></h3>
<p>GET – Launch the profile modal for the requested Peergos user (must be friend of current user)</p>
<p>/peergos-api/v0/profile/:username</p>
<p>Response code: 200 – success.  400 - failure.</p>
<p>GET – Retrieve the profile thumbnail image for the requested Peergos user (must be friend of current user + app has permission ACCESS_PROFILE_PHOTO)</p>
<p>/peergos-api/v0/profile/:username?thumbnail=true</p>
<p>Response code: 200 – success.  400 - failure.</p>
<p>Response:</p>
<p>{profileThumbnail: base64 data}</p>
<h2 id="developing-a-peergos-app"><a class="header" href="#developing-a-peergos-app">Developing a Peergos App</a></h2>
<p>Select the peergos-app.json file and choose ‘Run App’ to launch the app from the current directory.
This is only available for launchable apps.</p>
<p>Tip: During development, set the launchable property to get the fast dev cycle feedback.</p>
<p>The install process will detect if an existing App has the same name.
It will display the version of the already installed App.</p>
<p>During install the App's files are copied to an internal folder. Any existing contents in the assets folder will be replaced.
The contents of the data folder will be added to.<br />
The previously installed peergos-app.json file is copied to the App’s data directory as ‘peergos-app-previous.json’.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../features/open.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../features/private-web.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../features/open.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../features/private-web.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
